<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weather App</title>
  <style>
    body {font-family: Arial, sans-serif; background: linear-gradient(135deg, #74b9ff, #0984e3); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; transition: all 0.5s ease; overflow-x: auto;}

    @media (max-width: 768px) {
      body {
        padding: 10px;
        align-items: flex-start;
        padding-top: 20px;
      }

      .card {
        max-width: 100%;
        padding: 20px;
        margin: 0;
      }

      h1 {
        font-size: 20px;
      }

      .temp {
        font-size: 36px;
      }

      .details {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 5px;
      }

      .card {
        padding: 20px;
      }

      h1 {
        font-size: 18px;
        margin-bottom: 15px;
      }

      input, button, select {
        font-size: 12px;
        padding: 10px;
      }

      .temp {
        font-size: 32px;
      }

      .desc {
        font-size: 16px;
      }
    }
    body.clear {background: linear-gradient(135deg, #74b9ff, #0984e3);}
    body.clouds {background: linear-gradient(135deg, #636e72, #2d3436);}
    body.rain {background: linear-gradient(135deg, #2d3436, #636e72);}
    body.snow {background: linear-gradient(135deg, #ddd, #74b9ff);}
    body.thunderstorm {background: linear-gradient(135deg, #2d3436, #636e72);}
    body.drizzle {background: linear-gradient(135deg, #636e72, #2d3436);}
    body.mist {background: linear-gradient(135deg, #b2bec3, #636e72);}

    .card {background: rgba(255, 255, 255, 0.95); padding: 25px; border-radius: 15px; box-shadow: 0 8px 32px rgba(0,0,0,0.2); max-width: 450px; width: 100%; backdrop-filter: blur(10px);}
    h1 {font-size: 24px; text-align: center; margin-bottom: 20px; color: #2d3436;}
    input, button, select {width: 100%; padding: 12px; margin-top: 12px; border-radius: 8px; border: 1px solid #ccc; font-size: 14px; box-sizing: border-box;}
    button {background: #2563eb; color: white; border: none; cursor: pointer; font-weight: 600; transition: background 0.3s ease;}
    button:hover {background: #1e4ed8;}
    .info {margin-top: 25px; text-align: center; display: none;}
    .city-name {font-size: 20px; font-weight: bold; margin-bottom: 15px; color: #2d3436;}
    .temp {font-size: 48px; font-weight: bold; color: #2d3436; margin: 15px 0;}
    .desc {font-size: 18px; color: #636e72; margin-bottom: 20px; text-transform: capitalize;}
    .weather-main {font-size: 24px; font-weight: bold; color: #0984e3; margin-bottom: 10px;}
    img {width: 80px; height: 80px; margin: 10px auto; filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3)); display: block;}

    /* Custom sun icon styling */
    .sun-icon {
      width: 80px;
      height: 80px;
      margin: 10px auto;
      border-radius: 50%;
      background: radial-gradient(circle, #FFD700, #FFA500);
      box-shadow: 0 0 20px #FFD700, 0 0 40px #FFA500;
      animation: sun-glow 3s ease-in-out infinite alternate;
      display: block;
    }

    @keyframes sun-glow {
      0% { box-shadow: 0 0 20px #FFD700, 0 0 40px #FFA500; }
      100% { box-shadow: 0 0 30px #FFD700, 0 0 60px #FFA500; }
    }
    .details {display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; text-align: left;}
    .detail-item {background: rgba(116, 185, 255, 0.1); padding: 12px; border-radius: 8px; font-size: 14px;}
    .detail-label {font-weight: bold; color: #0984e3; display: block; margin-bottom: 5px;}
    .detail-value {color: #2d3436;}

    .rain-animation {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .rain-drop {
      position: absolute;
      width: 2px;
      height: 20px;
      background: rgba(255, 255, 255, 0.6);
      animation: fall 1s linear infinite;
    }

    @keyframes fall {
      0% { transform: translateY(-100vh); }
      100% { transform: translateY(100vh); }
    }

    .snow-animation {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .snow-flake {
      position: absolute;
      color: white;
      font-size: 1em;
      animation: snowfall 3s linear infinite;
    }

    @keyframes snowfall {
      0% { transform: translateY(-100vh) rotate(0deg); }
      100% { transform: translateY(100vh) rotate(360deg); }
    }
  </style>
</head>
<body>
<div class="card">
  <h1>Weather app</h1>
  <select id="countrySelect">
    <option value="">Select Country</option>
    <option value="United States">United States</option>
    <option value="United Kingdom">United Kingdom</option>
    <option value="Canada">Canada</option>
    <option value="Australia">Australia</option>
    <option value="Germany">Germany</option>
    <option value="France">France</option>
    <option value="Japan">Japan</option>
    <option value="China">China</option>
    <option value="India">India</option>
    <option value="Brazil">Brazil</option>
    <option value="Russia">Russia</option>
    <option value="Mongolia">Mongolia</option>
  </select>
  <input id="cityInput" placeholder="Enter city name" />
  <select id="unitSelect">
    <option value="metric">°C (Celsius)</option>
    <option value="imperial">°F (Fahrenheit)</option>
  </select>
  <button id="searchBtn">Get Weather</button>

  <div class="info" id="weatherInfo">
    <div class="city-name" id="cityName"></div>
    <div class="weather-main" id="weatherMain"></div>
    <img id="weatherIcon" alt="icon" />
    <div class="temp" id="temp"></div>
    <div class="desc" id="desc"></div>
    <div class="details" id="details"></div>
    <div class="weather-animation" id="weatherAnimation"></div>
  </div>
</div>

<script>
  const WEATHER_KEY = '298b95adcad4e9a5551a6bdc3d62cc7e';
  const LOCATIONIQ_KEY = 'pk.16c96a92daca9a4acef0053e57515e32';

  
  const elements = {
    countrySelect: document.getElementById('countrySelect'),
    cityInput: document.getElementById('cityInput'),
    unitSelect: document.getElementById('unitSelect'),
    searchBtn: document.getElementById('searchBtn'),
    infoBox: document.getElementById('weatherInfo'),
    cityName: document.getElementById('cityName'),
    weatherIcon: document.getElementById('weatherIcon'),
    temp: document.getElementById('temp'),
    desc: document.getElementById('desc'),
    details: document.getElementById('details'),
    weatherMain: document.getElementById('weatherMain'),
    weatherAnimation: document.getElementById('weatherAnimation')
  };

  
  async function searchLocation(query) {
    const url = `https://us1.locationiq.com/v1/search?key=${LOCATIONIQ_KEY}&q=${encodeURIComponent(query)}&format=json`;
    const res = await fetch(url);
    if (!res.ok) throw new Error('Failed to fetch locations');
    return await res.json();
  }

  async function handleSearch() {
    const country = elements.countrySelect.value;
    const city = elements.cityInput.value.trim();

    if (!country) return alert('Please select a country');
    if (!city) return alert('Please enter a city name');

    try {
      const locations = await searchLocation(`${country}, ${city}`);
      if (!locations.length) {
        alert('Location not found');
        elements.searchBtn.disabled = true;
        return;
      }

      const location = locations[0];
      await getWeather(location.lat, location.lon, location.display_name);
    } catch (err) {
      console.error(err);
      alert('Error: ' + err.message);
    }
  }

  function updateWeatherBackground(weather) {
    document.body.className = weather.toLowerCase();
  }

  function createWeatherAnimation(weather) {
    elements.weatherAnimation.innerHTML = '';
    const weatherType = weather.toLowerCase();

    if (weatherType === 'rain' || weatherType === 'drizzle') {
      createRainAnimation();
    } else if (weatherType === 'snow') {
      createSnowAnimation();
    }
  }

  function createRainAnimation() {
    const container = document.createElement('div');
    container.className = 'rain-animation';

    for (let i = 0; i < 50; i++) {
      const drop = document.createElement('div');
      drop.className = 'rain-drop';
      drop.style.left = Math.random() * 100 + '%';
      drop.style.animationDelay = Math.random() * 2 + 's';
      drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
      container.appendChild(drop);
    }

    elements.weatherAnimation.appendChild(container);
  }

  function createSnowAnimation() {
    const container = document.createElement('div');
    container.className = 'snow-animation';

    for (let i = 0; i < 30; i++) {
      const flake = document.createElement('div');
      flake.className = 'snow-flake';
      flake.textContent = '❄';
      flake.style.left = Math.random() * 100 + '%';
      flake.style.animationDelay = Math.random() * 3 + 's';
      flake.style.animationDuration = (Math.random() * 2 + 2) + 's';
      container.appendChild(flake);
    }

    elements.weatherAnimation.appendChild(container);
  }

  function setWeatherIcon(weather) {
    const existingSunIcon = document.getElementById('customSunIcon');
    if (existingSunIcon) existingSunIcon.remove();

    if (weather.main === 'Clear') {
      elements.weatherIcon.style.display = 'none';
      const sunIcon = document.createElement('div');
      sunIcon.className = 'sun-icon';
      sunIcon.id = 'customSunIcon';
      elements.weatherIcon.parentNode.insertBefore(sunIcon, elements.weatherIcon.nextSibling);
    } else {
      elements.weatherIcon.style.display = 'block';
      elements.weatherIcon.src = `https://openweathermap.org/img/wn/${weather.icon}@2x.png`;
    }
  }

  function updateWeatherDisplay(data, locationName, weather) {
    const units = elements.unitSelect.value;
    const tempUnit = units === 'metric' ? '°C' : '°F';
    const windUnit = units === 'metric' ? 'm/s' : 'mph';

    elements.cityName.textContent = locationName;
    elements.weatherMain.textContent = weather.main;
    setWeatherIcon(weather);
    elements.temp.textContent = `${Math.round(data.current.temp)}${tempUnit}`;
    elements.desc.textContent = weather.description;

    updateWeatherBackground(weather.main);
    createWeatherAnimation(weather.main);

    elements.details.innerHTML = `
      <div class="detail-item">
        <span class="detail-label">Humidity</span>
        <span class="detail-value">${data.current.humidity}%</span>
      </div>
      <div class="detail-item">
        <span class="detail-label">Wind Speed</span>
        <span class="detail-value">${data.current.wind_speed} ${windUnit}</span>
      </div>
    `;

    elements.infoBox.style.display = 'block';
  }

  async function getWeather(lat, lon, locationName) {
    const units = elements.unitSelect.value;
    const url = `https://api.openweathermap.org/data/3.0/onecall?lat=${lat}&lon=${lon}&exclude=minutely,hourly,daily,alerts&units=${units}&appid=${WEATHER_KEY}`;

    try {
      const res = await fetch(url);
      if (!res.ok) throw new Error('Failed to fetch weather');
      const data = await res.json();

      if (!data.current?.weather) throw new Error('Weather data unavailable');

      updateWeatherDisplay(data, locationName, data.current.weather[0]);
    } catch (err) {
      console.error(err);
      alert('Error: ' + err.message);
    }
  }

  elements.searchBtn.addEventListener('click', handleSearch);
  elements.cityInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') handleSearch();
  });
  elements.countrySelect.addEventListener('change', () => {
    elements.searchBtn.disabled = false;
    elements.infoBox.style.display = 'none';
  });
</script>
</body>
</html>

